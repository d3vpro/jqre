import{JNode,JMain}from"./jqre.js";JNode.prototype.after=function(...e){return JMain._internal.baseManipulation.call(this,"after",...e)},JNode.prototype.insertAfter=function(e){return(new JNode).add(e).after(this)},JNode.prototype.before=function(...e){return JMain._internal.baseManipulation.call(this,"before",...e)},JNode.prototype.insertBefore=function(e){return(new JNode).add(e).before(this)},JNode.prototype.append=function(...e){return JMain._internal.baseManipulation.call(this,"append",...e)},JNode.prototype.appendTo=function(e){return(new JNode).add(e).append(this)},JNode.prototype.prepend=function(...e){return JMain._internal.baseManipulation.call(this,"prepend",...e)},JNode.prototype.prependTo=function(e){return(new JNode).add(e).prepend(this)},JNode.prototype.replaceWith=function(...e){return this.off(),JMain._internal.baseManipulation.call(this,"replaceWith",...e)},JNode.prototype.replaceAll=function(e){return e instanceof JNode||(e=(new JNode).add(e)),e.replaceWith(this)},JNode.prototype.clone=function(e=!1,t=null){t=t??e;const n=new JNode;let o;for(const r of this)if(o=t&&r.children.length?(new JNode).add(r.cloneNode(!1)).append((new JNode).add(r.children).clone(e,t)):r.cloneNode(!0),n.add(o),e)for(let e in JMain._internal.eventHandler.functionMap)for(const t of JMain._internal.eventHandler.functionMap[e])t.target===r&&JMain._internal.eventHandler.addEventListener(o,e,t.listener,t.useCapture,t.selector,t.data);return n},JNode.prototype.wrap=function(e){if("function"==typeof e){let t;for(const[n,o]of this.entries())t=e.call(this,n),t="string"==typeof t?(new JNode).add(t).html(o.outerHTML)[0]:t.html(o.outerHTML)[0],o.parentNode.replaceChild(t,o);return this}e=(new JNode).add(e,!0),this.off();for(const t of this)t.parentNode.replaceChild(e.clone().html(t.outerHTML)[0],t);return this},JNode.prototype.remove=function(e=null){if(null===e){this.off();for(const e of this)e.parentNode.removeChild(e);return new JNode}{const t=new JNode,n=new JNode;for(const o of this)o.matches(e)?t.add(o):n.add(o);return t.remove(),n}},JNode.prototype.empty=function(){for(const e of this)e.innerHTML="";return this},JNode.prototype.html=function(e=null){for(const[t,n]of this.entries()){if(null===e)return n.innerHTML;n.innerHTML="function"==typeof e?e.call(n,t,n.innerHTML):e}return this},JNode.prototype.runScripts=function(){const r=new JNode;for(const e of this)"SCRIPT"===e.tagName?r.add(e):r.add(e.getElementsByTagName("script"));for(const n of r){const type=n.getAttribute("type");if(!type||-1!==type.indexOf("script")){const src=n.getAttribute("src");if(src){const e=document.createElement("script");e.setAttribute("type",type),e.setAttribute("src",src),e.addEventListener("load",(function(e){e.target.remove()})),document.getElementsByTagName("head").item(0).appendChild(e)}else eval(n.textContent)}}return this},JNode.prototype.text=function(e=null){for(const[t,n]of this.entries()){if(null===e)return n.textContent;n.textContent="function"==typeof e?e.call(n,t,n.textContent):e}return this},JMain._internal.baseManipulation=function(e,...t){let n;for(const o of t){"function"!=typeof o&&(n=(new JNode).add(o));for(const[t,r]of this.entries()){"function"==typeof o&&(n=(new JNode).add(o.call(r,t,r.innerHTML)));for(const[i,a]of n.entries())t+1<this.length&&"function"!=typeof o?r[e](a.cloneNode(!0)):"replaceWith"===e&&i+1<n.length?r.before(a):r[e](a)}}return this};